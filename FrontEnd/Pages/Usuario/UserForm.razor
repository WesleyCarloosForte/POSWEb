@page "/Usuario/Registrar"
@using FrontEnd.Components
@using SharedProject.DTOs
@using System.ComponentModel.DataAnnotations.Schema
@using System.ComponentModel.DataAnnotations
@using System.Collections.Generic
@using System.Linq


<FormGeneric T="UsuarioCreateDTO"
             FormData="@miObjeto"
             Save="@(async () => await HandleSave(miObjeto))"
             GotoNextPage="HandleGotoNextPage"
             Title="Registro de Usuario"
             ForeignKeyData="foreignKeysData" />


@code {
    private UsuarioCreateDTO miObjeto = new UsuarioCreateDTO();

    private async Task HandleSave(UsuarioCreateDTO data)
    {
        // Lógica para guardar el objeto 'data' (UsuarioCreateDTO)
    }

    private async Task HandleGotoNextPage()
    {
        // Lógica para ir a la siguiente página
    }

    private Dictionary<string, IEnumerable<object>> foreignKeysData;

    protected override void OnInitialized()
    {
        foreignKeysData = new Dictionary<string, IEnumerable<object>>();
        LoadForeignKeyData();
    }

    private void LoadForeignKeyData()
    {
        // Cargar los datos de las llaves foráneas
        LoadDocumentoData();
        LoadRolData();
    }

    private void LoadDocumentoData()
    {
        var documentoData = new List<DocumentoViewDTO>
        {
            new DocumentoViewDTO { Id = 1, Descripcion = "DNI" },
            new DocumentoViewDTO { Id = 2, Descripcion = "Pasaporte" },
            new DocumentoViewDTO { Id = 3, Descripcion = "Carnet de identidad" }
        };

        foreignKeysData["Documento"] = documentoData.Cast<object>();
    }

    private void LoadRolData()
    {
        var rolData = new List<RolViewDTO>
        {
            new RolViewDTO { Id = 1, Descripcion = "Administrador" },
            new RolViewDTO { Id = 2, Descripcion = "Usuario regular" },
            new RolViewDTO { Id = 3, Descripcion = "Invitado" }
        };

        foreignKeysData["Rol"] = rolData.Cast<object>();
    }
}
